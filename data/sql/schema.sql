CREATE TABLE t_category (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, UNIQUE INDEX u_name_idx (name), UNIQUE INDEX t_category_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_chapter (id BIGINT AUTO_INCREMENT, code VARCHAR(15) NOT NULL, name VARCHAR(200) NOT NULL, description TEXT, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_name_idx (name), UNIQUE INDEX u_code_idx (code), UNIQUE INDEX u_name_idx (name), INDEX i_active_idx (active), UNIQUE INDEX t_chapter_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_comment (id BIGINT AUTO_INCREMENT, post_id BIGINT NOT NULL, user_id BIGINT, author_name VARCHAR(100) NOT NULL, author_email VARCHAR(100) NOT NULL, author_url VARCHAR(200), author_twitter_username VARCHAR(100), author_ip VARCHAR(100) NOT NULL, content TEXT NOT NULL, datetime datetime NOT NULL, agent VARCHAR(255) NOT NULL, approved CHAR(1) DEFAULT '0' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_author_name_idx (author_name), INDEX i_author_email_idx (author_email), INDEX i_author_url_idx (author_url), INDEX i_author_twitter_username_idx (author_twitter_username), INDEX i_author_ip_idx (author_ip), INDEX i_datetime_idx (datetime), INDEX i_approved_idx (approved), UNIQUE INDEX t_comment_sluggable_idx (slug), INDEX post_id_idx (post_id), INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_company (id BIGINT AUTO_INCREMENT, name VARCHAR(200), description TEXT, address VARCHAR(200) NOT NULL, phones VARCHAR(200) NOT NULL, fax VARCHAR(200), mobile_phone VARCHAR(200), mail VARCHAR(200), box VARCHAR(200), image VARCHAR(200), message TEXT, active CHAR(1) DEFAULT '0' NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, slug VARCHAR(255), INDEX i_active_idx (active), UNIQUE INDEX t_company_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_contact (id BIGINT AUTO_INCREMENT, firstname VARCHAR(100) NOT NULL, lastname VARCHAR(100) NOT NULL, gender CHAR(1) DEFAULT '1' NOT NULL, email VARCHAR(100), home_phone VARCHAR(200), office_phone VARCHAR(200), mobile_phone VARCHAR(200), rpm VARCHAR(200), rpc VARCHAR(200), nextel VARCHAR(200), fax VARCHAR(200), address_home VARCHAR(200), address_work VARCHAR(200), description TEXT, prefix CHAR(1) DEFAULT '1' NOT NULL, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_firstname_idx (firstname), INDEX i_lastname_idx (lastname), INDEX i_active_idx (active), UNIQUE INDEX t_contact_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_contact_patient (contact_id BIGINT, patient_id BIGINT, created_at DATETIME NOT NULL, PRIMARY KEY(contact_id, patient_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_diagnosis (id BIGINT AUTO_INCREMENT, group_id BIGINT NOT NULL, code VARCHAR(5) NOT NULL, name TEXT NOT NULL, description TEXT, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, UNIQUE INDEX u_code_idx (code), INDEX i_active_idx (active), UNIQUE INDEX t_diagnosis_sluggable_idx (slug), INDEX group_id_idx (group_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_doctor (id BIGINT AUTO_INCREMENT, specialty_id BIGINT NOT NULL, firstname VARCHAR(100) NOT NULL, lastname VARCHAR(100) NOT NULL, gender CHAR(1) DEFAULT '1' NOT NULL, email VARCHAR(100) NOT NULL, username VARCHAR(50), password VARCHAR(255), home_phone VARCHAR(200), office_phone VARCHAR(200), mobile_phone VARCHAR(200), fax VARCHAR(200), description TEXT, prefix CHAR(1) DEFAULT '1' NOT NULL, active CHAR(1) DEFAULT '1' NOT NULL, last_access_at DATETIME, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_firstname_idx (firstname), INDEX i_lastname_idx (lastname), UNIQUE INDEX u_email_idx (email), INDEX i_active_idx (active), UNIQUE INDEX t_doctor_sluggable_idx (slug), INDEX specialty_id_idx (specialty_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_doctor_hospital (doctor_id BIGINT, hospital_id BIGINT, created_at DATETIME NOT NULL, PRIMARY KEY(doctor_id, hospital_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_doctor_patient (doctor_id BIGINT, patient_id BIGINT, created_at DATETIME NOT NULL, PRIMARY KEY(doctor_id, patient_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_group (id BIGINT AUTO_INCREMENT, chapter_id BIGINT NOT NULL, code VARCHAR(5) NOT NULL, name TEXT NOT NULL, description TEXT, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, UNIQUE INDEX u_code_idx (code), INDEX i_active_idx (active), UNIQUE INDEX t_group_sluggable_idx (slug), INDEX chapter_id_idx (chapter_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_height (id BIGINT AUTO_INCREMENT, profile_id BIGINT NOT NULL, current_height DECIMAL(10, 2), date_of_height DATE, description TEXT, active CHAR(1) DEFAULT '0' NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_current_height_idx (current_height), INDEX i_active_idx (active), INDEX profile_id_idx (profile_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_hospital (id BIGINT AUTO_INCREMENT, code VARCHAR(5) NOT NULL, name VARCHAR(100) NOT NULL, address TEXT, phone VARCHAR(100), description TEXT, type CHAR(1) DEFAULT '1' NOT NULL, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_name_idx (name), UNIQUE INDEX u_code_idx (code), UNIQUE INDEX u_name_idx (name), INDEX i_active_idx (active), UNIQUE INDEX t_hospital_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_patient (id BIGINT AUTO_INCREMENT, realname VARCHAR(200) NOT NULL, username VARCHAR(50) NOT NULL, password VARCHAR(255) NOT NULL, email VARCHAR(100) NOT NULL, url VARCHAR(255), twitter_username VARCHAR(100), phone VARCHAR(100), active CHAR(1) DEFAULT '0' NOT NULL, last_access_at DATETIME, facebook_id VARCHAR(20), slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_username_idx (username), UNIQUE INDEX u_email_idx (email), UNIQUE INDEX u_facebook_id_idx (facebook_id), INDEX i_url_idx (url), INDEX i_twitter_username_idx (twitter_username), INDEX i_active_idx (active), UNIQUE INDEX t_patient_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_patient_profile (patient_id BIGINT, profile_id BIGINT, created_at DATETIME NOT NULL, PRIMARY KEY(patient_id, profile_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_post (id BIGINT AUTO_INCREMENT, user_id BIGINT NOT NULL, title VARCHAR(200) NOT NULL, image VARCHAR(200) DEFAULT '' NOT NULL, content TEXT NOT NULL, excerpt TEXT NOT NULL, meta_description TEXT NOT NULL, meta_keywords TEXT NOT NULL, datetime datetime NOT NULL, status CHAR(2) DEFAULT 'PE' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, UNIQUE INDEX u_title_idx (title), INDEX i_datetime_idx (datetime), INDEX i_status_idx (status), UNIQUE INDEX t_post_sluggable_idx (slug), INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_post_category (post_id BIGINT, category_id BIGINT, created_at DATETIME NOT NULL, PRIMARY KEY(post_id, category_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_post_index (id BIGINT AUTO_INCREMENT, post_id BIGINT NOT NULL, title VARCHAR(200) NOT NULL, content TEXT NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, UNIQUE INDEX t_post_index_sluggable_idx (slug), INDEX post_id_idx (post_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_profile (id BIGINT AUTO_INCREMENT, dni VARCHAR(8) NOT NULL, firstname VARCHAR(100) NOT NULL, lastname VARCHAR(100) NOT NULL, date_of_birth DATE, gender CHAR(1), image VARCHAR(105) DEFAULT NULL, description TEXT, type CHAR(1), blood_type CHAR(1), marital_status CHAR(1), active CHAR(1) DEFAULT '0' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_firstname_idx (firstname), UNIQUE INDEX u_dni_idx (dni), INDEX i_gender_idx (gender), INDEX i_active_idx (active), UNIQUE INDEX t_profile_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_resource (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL, path VARCHAR(255) NOT NULL, size BIGINT DEFAULT 0 NOT NULL, full_mime VARCHAR(100) NOT NULL, rank BIGINT DEFAULT 0 NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_name_idx (name), UNIQUE INDEX t_resource_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_resource_patient (resource_id BIGINT, patient_id BIGINT, created_at DATETIME NOT NULL, PRIMARY KEY(resource_id, patient_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_specialty (id BIGINT AUTO_INCREMENT, code VARCHAR(5) NOT NULL, name VARCHAR(100) NOT NULL, description TEXT, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_name_idx (name), UNIQUE INDEX u_code_idx (code), UNIQUE INDEX u_name_idx (name), INDEX i_active_idx (active), UNIQUE INDEX t_specialty_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_sponsor (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL, url VARCHAR(100) NOT NULL, description TEXT, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, UNIQUE INDEX u_name_idx (name), UNIQUE INDEX t_sponsor_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_treatment (id BIGINT AUTO_INCREMENT, doctor_id BIGINT NOT NULL, profile_id BIGINT NOT NULL, hospital_id BIGINT NOT NULL, date_of_treatment DATE, description TEXT, active CHAR(1) DEFAULT '1' NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_active_idx (active), INDEX profile_id_idx (profile_id), INDEX doctor_id_idx (doctor_id), INDEX hospital_id_idx (hospital_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_treatment_diagnosis (treatment_id BIGINT, diagnosis_id BIGINT, created_at DATETIME NOT NULL, PRIMARY KEY(treatment_id, diagnosis_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_user (id BIGINT AUTO_INCREMENT, realname VARCHAR(200) NOT NULL, username VARCHAR(50) NOT NULL, password VARCHAR(255) NOT NULL, email VARCHAR(100) NOT NULL, url VARCHAR(255), twitter_username VARCHAR(100), phone VARCHAR(100), active CHAR(1) DEFAULT '0' NOT NULL, last_access_at DATETIME, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_username_idx (username), UNIQUE INDEX u_email_idx (email), INDEX i_url_idx (url), INDEX i_twitter_username_idx (twitter_username), INDEX i_active_idx (active), UNIQUE INDEX t_user_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_visit (id BIGINT AUTO_INCREMENT, remote_address VARCHAR(50) NOT NULL, remote_port VARCHAR(50) NOT NULL, http_user_agent VARCHAR(255) NOT NULL, datetime datetime NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_remote_address_idx (remote_address), INDEX i_datetime_idx (datetime), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_weight (id BIGINT AUTO_INCREMENT, profile_id BIGINT NOT NULL, current_weight DECIMAL(10, 2), expected_weight DECIMAL(10, 2), date_of_weight DATE, description TEXT, active CHAR(1) DEFAULT '0' NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_current_weight_idx (current_weight), INDEX i_active_idx (active), INDEX profile_id_idx (profile_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
ALTER TABLE t_comment ADD CONSTRAINT t_comment_user_id_t_user_id FOREIGN KEY (user_id) REFERENCES t_user(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_comment ADD CONSTRAINT t_comment_post_id_t_post_id FOREIGN KEY (post_id) REFERENCES t_post(id) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE t_contact_patient ADD CONSTRAINT t_contact_patient_patient_id_t_patient_id FOREIGN KEY (patient_id) REFERENCES t_patient(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_contact_patient ADD CONSTRAINT t_contact_patient_contact_id_t_contact_id FOREIGN KEY (contact_id) REFERENCES t_contact(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_diagnosis ADD CONSTRAINT t_diagnosis_group_id_t_group_id FOREIGN KEY (group_id) REFERENCES t_group(id) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE t_doctor ADD CONSTRAINT t_doctor_specialty_id_t_specialty_id FOREIGN KEY (specialty_id) REFERENCES t_specialty(id) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE t_doctor_hospital ADD CONSTRAINT t_doctor_hospital_hospital_id_t_hospital_id FOREIGN KEY (hospital_id) REFERENCES t_hospital(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_doctor_hospital ADD CONSTRAINT t_doctor_hospital_doctor_id_t_doctor_id FOREIGN KEY (doctor_id) REFERENCES t_doctor(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_doctor_patient ADD CONSTRAINT t_doctor_patient_patient_id_t_patient_id FOREIGN KEY (patient_id) REFERENCES t_patient(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_doctor_patient ADD CONSTRAINT t_doctor_patient_doctor_id_t_doctor_id FOREIGN KEY (doctor_id) REFERENCES t_doctor(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_group ADD CONSTRAINT t_group_chapter_id_t_chapter_id FOREIGN KEY (chapter_id) REFERENCES t_chapter(id) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE t_height ADD CONSTRAINT t_height_profile_id_t_profile_id FOREIGN KEY (profile_id) REFERENCES t_profile(id) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE t_patient_profile ADD CONSTRAINT t_patient_profile_profile_id_t_profile_id FOREIGN KEY (profile_id) REFERENCES t_profile(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_patient_profile ADD CONSTRAINT t_patient_profile_patient_id_t_patient_id FOREIGN KEY (patient_id) REFERENCES t_patient(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_post ADD CONSTRAINT t_post_user_id_t_user_id FOREIGN KEY (user_id) REFERENCES t_user(id) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE t_post_category ADD CONSTRAINT t_post_category_post_id_t_post_id FOREIGN KEY (post_id) REFERENCES t_post(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_post_category ADD CONSTRAINT t_post_category_category_id_t_category_id FOREIGN KEY (category_id) REFERENCES t_category(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_post_index ADD CONSTRAINT t_post_index_post_id_t_post_id FOREIGN KEY (post_id) REFERENCES t_post(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_resource_patient ADD CONSTRAINT t_resource_patient_resource_id_t_resource_id FOREIGN KEY (resource_id) REFERENCES t_resource(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_resource_patient ADD CONSTRAINT t_resource_patient_patient_id_t_patient_id FOREIGN KEY (patient_id) REFERENCES t_patient(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_treatment ADD CONSTRAINT t_treatment_profile_id_t_profile_id FOREIGN KEY (profile_id) REFERENCES t_profile(id) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE t_treatment ADD CONSTRAINT t_treatment_hospital_id_t_hospital_id FOREIGN KEY (hospital_id) REFERENCES t_hospital(id) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE t_treatment ADD CONSTRAINT t_treatment_doctor_id_t_doctor_id FOREIGN KEY (doctor_id) REFERENCES t_doctor(id) ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE t_treatment_diagnosis ADD CONSTRAINT t_treatment_diagnosis_treatment_id_t_treatment_id FOREIGN KEY (treatment_id) REFERENCES t_treatment(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_treatment_diagnosis ADD CONSTRAINT t_treatment_diagnosis_diagnosis_id_t_diagnosis_id FOREIGN KEY (diagnosis_id) REFERENCES t_diagnosis(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_weight ADD CONSTRAINT t_weight_profile_id_t_profile_id FOREIGN KEY (profile_id) REFERENCES t_profile(id) ON UPDATE CASCADE ON DELETE RESTRICT;
